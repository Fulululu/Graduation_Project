###############################################################################
#
# IAR C/C++ Compiler V9.30.1.3056 for 8051                22/May/2018  20:40:26
# Copyright 2004-2015 IAR Systems AB.
# Standalone license - IAR Embedded Workbench for 8051
#
#    Core               =  plain
#    Code model         =  banked
#    Data model         =  large
#    Calling convention =  xdata reentrant
#    Constant location  =  data_rom
#    Dptr setup         =  1,16
#                          
#    Source file        =  
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c
#    Command line       =  
#        -f
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wEndev.cfg
#        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3
#        -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3) -f
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg
#        (-DZIGBEEPRO -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
#        -DDEFAULT_CHANLIST=0x00000800 -DZDAPP_CONFIG_PAN_ID=0x333;
#        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
#        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
#        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
#        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
#        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3
#        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
#        -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4
#        -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07,
#        0x09, 0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C,
#        0x0D}" -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS=20
#        "-DCONST=const __code" -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE
#        -DPOLL_RATE=0 -DQUEUED_POLL_RATE=0 -DRESPONSE_POLL_RATE=0)
#        -DREJOIN_POLL_RATE=1000
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c
#        -D NWK_AUTO_POLL -D ZTOOL_P1 -D xMT_TASK -D xMT_SYS_FUNC -D
#        xMT_ZDO_FUNC -D xLCD_SUPPORTED=DEBUG -D POWER_SAVING -lC
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\EndDeviceEB\List
#        -lA
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\EndDeviceEB\List
#        --diag_suppress Pe001,Pa010 -o
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\EndDeviceEB\Obj
#        -e --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa --debug
#        --core=plain --dptr=16,1 --data_model=large --code_model=banked
#        --calling_convention=xdata_reentrant --place_constants=data_rom
#        --nr_virtual_regs 8 -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\ -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\Source\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\ZMain\TI2530DB\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\hal\include\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\hal\target\CC2530EB\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mac\include\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mac\high_level\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\single_chip\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mt\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\osal\include\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\services\saddr\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\services\sdata\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\af\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\nwk\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\sapi\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\sec\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\sys\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\zdo\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\zmac\
#        -I
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\zmac\f8w\
#        -On --require_prototypes
#    List file          =  
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\EndDeviceEB\List\SampleApp.lst
#    Object file        =  
#        D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\EndDeviceEB\Obj\SampleApp.r51
#
###############################################################################

D:\design\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c
      1          #include "OSAL.h"
      2          #include "ZGlobals.h"
      3          #include "AF.h"
      4          #include "aps_groups.h"
      5          #include "ZDApp.h"
      6          
      7          #include "SampleApp.h"
      8          #include "SampleAppHw.h"
      9          
     10          #include "OnBoard.h"  //incorporate har_uart.h 
     11          
     12          //#include <stdio.h>
     13          #include "IIC.h"
     14          #include "BH1750FVI.h"
     15          #include "SHT10.h"
     16          #include "PMS7003.h"
     17          #include "DS_CO2_20.h"
     18          #include "Soilhumi.h"
     19          #include "ds18b20.h"
     20          #include "ZE03.h"
     21          
     22          /* HAL */
     23          #include "hal_lcd.h"
     24          #include "hal_led.h"
     25          #include "hal_key.h"
     26          #include "MT_UART.h"
     27          #include "MT_APP.h"
     28          #include "MT.h"
     29          #include "hal_adc.h"
     30          #include "hal_uart.h"
     31          
     32          /*********************************************************************
     33           * MACROS
     34           */
     35          #if defined( ZDO_COORDINATOR ) 
     36          #define RELAY P0_4
     37          #endif
     38          
     39          /*********************************************************************
     40           * CONSTANTS
     41           */
     42          
     43          /*********************************************************************
     44           * TYPEDEFS
     45           */
     46          
     47          /*********************************************************************
     48           * GLOBAL VARIABLES
     49           */
     50          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     51          uint8 LedState = 0;
   \                     LedState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     52          
     53          // This list should be filled with Application specific Cluster IDs.

   \                                 In  segment XDATA_ROM_C, align 1
     54          const cId_t SampleApp_ClusterList[SAMPLEAPP_MAX_CLUSTERS] =
   \                     SampleApp_ClusterList:
   \   000000   0200         DW 2
   \   000002   0300         DW 3
   \   000004   0000         DW 0
     55          {
     56            SAMPLEAPP_BROADCAST_CLUSTERID,
     57            SAMPLEAPP_P2P_CLUSTERID
     58          };
     59          

   \                                 In  segment XDATA_ROM_C, align 1
     60          const SimpleDescriptionFormat_t SampleApp_SimpleDesc =
   \                     SampleApp_SimpleDesc:
   \   000000   0B           DB 11
   \   000001   080F         DW 3848
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   03           DB 3
   \   000007   ....         DW SampleApp_ClusterList
   \   000009   03           DB 3
   \   00000A   ....         DW SampleApp_ClusterList
     61          {
     62            SAMPLEAPP_ENDPOINT,              //  int Endpoint;
     63            SAMPLEAPP_PROFID,                //  uint16 AppProfId[2];
     64            SAMPLEAPP_DEVICEID,              //  uint16 AppDeviceId[2];
     65            SAMPLEAPP_DEVICE_VERSION,        //  int   AppDevVer:4;
     66            SAMPLEAPP_FLAGS,                 //  int   AppFlags:4;
     67            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
     68            (cId_t *)SampleApp_ClusterList,  //  uint8 *pAppInClusterList;
     69            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
     70            (cId_t *)SampleApp_ClusterList   //  uint8 *pAppInClusterList;
     71          };
     72          
     73          // This is the Endpoint/Interface description.  It is defined here, but
     74          // filled-in in SampleApp_Init().  Another way to go would be to fill
     75          // in the structure here and make it a "const" (in code space).  The
     76          // way it's defined in this sample app it is define in RAM.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     77          endPointDesc_t SampleApp_epDesc;
   \                     SampleApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z
     78          
     79          /*********************************************************************
     80           * EXTERNAL VARIABLES
     81           */
     82          //20171108 add rxLen and MT_RX_Buffer
     83          extern uint8 MT_RX_Buffer[];
     84          extern uint16 rxLen;
     85          extern uint8 frame[];
     86          /*********************************************************************
     87           * EXTERNAL FUNCTIONS
     88           */
     89          
     90          /*********************************************************************
     91           * LOCAL VARIABLES
     92           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     93          uint8 SampleApp_TaskID;   // Task ID for internal task/event processing
   \                     SampleApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     94                                    // This variable will be received when
     95                                    // SampleApp_Init() is called.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     96          devStates_t SampleApp_NwkState;
   \                     SampleApp_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     97          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     98          uint8 SampleApp_TransID;  // This is the unique message ID (counter)
   \                     SampleApp_TransID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     99          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    100          afAddrType_t SampleApp_Broadcast_DstAddr; //广播描述符
   \                     SampleApp_Broadcast_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    101          afAddrType_t SampleApp_Group_DstAddr;    //组播描述符
   \                     SampleApp_Group_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    102          afAddrType_t SampleApp_P2P_DstAddr;      //点播描述符
   \                     SampleApp_P2P_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
    103          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    104          aps_Group_t SampleApp_Group;
   \                     SampleApp_Group:
   \   000000                DS 18
   \   000012                REQUIRE __INIT_XDATA_Z
    105          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    106          uint8 myRXbuf[2];
   \                     myRXbuf:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    107          uint8 len = 0;
   \                     len:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    108          uint8 lightbuf[5];
   \                     lightbuf:
   \   000000                DS 5
   \   000005                REQUIRE __INIT_XDATA_Z
    109                      
    110          /*********************************************************************
    111           * LOCAL FUNCTIONS
    112           */
    113          void SampleApp_HandleKeys( uint8 shift, uint8 keys );
    114          void SampleApp_coord_HandleMsg( afIncomingMSGPacket_t *pckt );
    115          void SampleApp_router_HandleMsg( afIncomingMSGPacket_t *pckt );
    116          void SampleApp_end_HandleMsg( afIncomingMSGPacket_t *pckt );
    117          
    118          void SampleApp_coord_HandlerUART(void);
    119          void SampleApp_Send_P2P_Message(void);
    120          uint8 Soilhumi_Read_Str(uint8 *tmp);
    121          
    122          
    123          /*********************************************************************
    124           * NETWORK LAYER CALLBACKS
    125           */
    126          
    127          /*********************************************************************
    128           * PUBLIC FUNCTIONS
    129           */
    130          
    131          /*********************************************************************
    132           * @fn      SampleApp_Init
    133           *
    134           * @brief   Initialization function for the Generic App Task.
    135           *          This is called during initialization and should contain
    136           *          any application specific initialization (ie. hardware
    137           *          initialization/setup, table initialization, power up
    138           *          notificaiton ... ).
    139           *
    140           * @param   task_id - the ID assigned by OSAL.  This ID should be
    141           *                    used to send messages and set timers.
    142           *
    143           * @return  none
    144           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    145          void SampleApp_Init( uint8 task_id )
   \                     SampleApp_Init:
    146          { 
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    147            SampleApp_TaskID = task_id;	        //保存OSAL分配的任务ID
   \   000007   EE           MOV     A,R6
   \   000008   90....       MOV     DPTR,#SampleApp_TaskID
   \   00000B   F0           MOVX    @DPTR,A
    148            SampleApp_NwkState = DEV_INIT;	//设备网络状态设置为初始化网络状态初始化应用设备的网络类型
   \   00000C   90....       MOV     DPTR,#SampleApp_NwkState
   \   00000F   7401         MOV     A,#0x1
   \   000011   F0           MOVX    @DPTR,A
    149            SampleApp_TransID = 0;	        //设置消息发送ID
   \   000012   90....       MOV     DPTR,#SampleApp_TransID
   \   000015   7400         MOV     A,#0x0
   \   000017   F0           MOVX    @DPTR,A
    150            
    151            //判断该设备是协调器 还是 路由器
    152          #if defined ( BUILD_ALL_DEVICES )
    153            if ( readCoordinatorJumper() )
    154              zgDeviceLogicalType = ZG_DEVICETYPE_COORDINATOR;
    155            else
    156              zgDeviceLogicalType = ZG_DEVICETYPE_ROUTER;
    157          #endif
    158            
    159            //1、初始化端点描述符（不同端点应不同）并向AF层注册(端点不是终端相当于端口号)
    160          	  // Fill out the endpoint description.
    161            SampleApp_epDesc.endPoint = SAMPLEAPP_ENDPOINT;
   \   000018   90....       MOV     DPTR,#SampleApp_epDesc
   \   00001B   740B         MOV     A,#0xb
   \   00001D   F0           MOVX    @DPTR,A
    162            SampleApp_epDesc.task_id = &SampleApp_TaskID;
   \   00001E   90....       MOV     DPTR,#SampleApp_epDesc + 1
   \   000021   74..         MOV     A,#SampleApp_TaskID & 0xff
   \   000023   F0           MOVX    @DPTR,A
   \   000024   A3           INC     DPTR
   \   000025   74..         MOV     A,#(SampleApp_TaskID >> 8) & 0xff
   \   000027   F0           MOVX    @DPTR,A
    163            SampleApp_epDesc.simpleDesc
    164                      = (SimpleDescriptionFormat_t *)&SampleApp_SimpleDesc;
   \   000028   90....       MOV     DPTR,#SampleApp_epDesc + 3
   \   00002B   74..         MOV     A,#SampleApp_SimpleDesc & 0xff
   \   00002D   F0           MOVX    @DPTR,A
   \   00002E   A3           INC     DPTR
   \   00002F   74..         MOV     A,#(SampleApp_SimpleDesc >> 8) & 0xff
   \   000031   F0           MOVX    @DPTR,A
    165            SampleApp_epDesc.latencyReq = noLatencyReqs;		
   \   000032   90....       MOV     DPTR,#SampleApp_epDesc + 5
   \   000035   7400         MOV     A,#0x0
   \   000037   F0           MOVX    @DPTR,A
    166          	  // Register the endpoint description with the AF
    167            afRegister( &SampleApp_epDesc );   
   \   000038                ; Setup parameters for call to function afRegister
   \   000038   7A..         MOV     R2,#SampleApp_epDesc & 0xff
   \   00003A   7B..         MOV     R3,#(SampleApp_epDesc >> 8) & 0xff
   \   00003C   12....       LCALL   `??afRegister::?relay`; Banked call to: afRegister
   \   00003F   E9           MOV     A,R1
    168          
    169            //2、设置af发送的地址描述符（包含数据发送寻址模式及目的地址信息）
    170            SampleApp_Group_DstAddr.addrMode = (afAddrMode_t)afAddrGroup;	  //组寻址
   \   000040   90....       MOV     DPTR,#SampleApp_Group_DstAddr + 8
   \   000043   7401         MOV     A,#0x1
   \   000045   F0           MOVX    @DPTR,A
    171            SampleApp_Group_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;	  //指定端点号
   \   000046   90....       MOV     DPTR,#SampleApp_Group_DstAddr + 9
   \   000049   740B         MOV     A,#0xb
   \   00004B   F0           MOVX    @DPTR,A
    172            SampleApp_Group_DstAddr.addr.shortAddr = SAMPLEAPP_GROUP_ADDR;    //组地址
   \   00004C   90....       MOV     DPTR,#SampleApp_Group_DstAddr
   \   00004F   7411         MOV     A,#0x11
   \   000051   F0           MOVX    @DPTR,A
   \   000052   A3           INC     DPTR
   \   000053   7401         MOV     A,#0x1
   \   000055   F0           MOVX    @DPTR,A
    173            
    174            SampleApp_Broadcast_DstAddr.addrMode = (afAddrMode_t)AddrBroadcast;//广播寻址
   \   000056   90....       MOV     DPTR,#SampleApp_Broadcast_DstAddr + 8
   \   000059   740F         MOV     A,#0xf
   \   00005B   F0           MOVX    @DPTR,A
    175            SampleApp_Broadcast_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;	//指定端点号
   \   00005C   90....       MOV     DPTR,#SampleApp_Broadcast_DstAddr + 9
   \   00005F   740B         MOV     A,#0xb
   \   000061   F0           MOVX    @DPTR,A
    176            SampleApp_Broadcast_DstAddr.addr.shortAddr = 0xFFFF;	        //广播地址 
   \   000062   90....       MOV     DPTR,#SampleApp_Broadcast_DstAddr
   \   000065   74FF         MOV     A,#-0x1
   \   000067   F0           MOVX    @DPTR,A
   \   000068   A3           INC     DPTR
   \   000069   74FF         MOV     A,#-0x1
   \   00006B   F0           MOVX    @DPTR,A
    177            
    178            SampleApp_P2P_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;     //点播寻址 
   \   00006C   90....       MOV     DPTR,#SampleApp_P2P_DstAddr + 8
   \   00006F   7402         MOV     A,#0x2
   \   000071   F0           MOVX    @DPTR,A
    179            SampleApp_P2P_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;          //指定端点号
   \   000072   90....       MOV     DPTR,#SampleApp_P2P_DstAddr + 9
   \   000075   740B         MOV     A,#0xb
   \   000077   F0           MOVX    @DPTR,A
    180            SampleApp_P2P_DstAddr.addr.shortAddr = 0;                     //不指定
   \   000078   90....       MOV     DPTR,#SampleApp_P2P_DstAddr
   \   00007B   7400         MOV     A,#0x0
   \   00007D   F0           MOVX    @DPTR,A
   \   00007E   A3           INC     DPTR
   \   00007F   7400         MOV     A,#0x0
   \   000081   F0           MOVX    @DPTR,A
    181            
    182            //3、初始化组描述符
    183            SampleApp_Group.ID = SAMPLEAPP_GROUP_ADDR;	        //组号
   \   000082   90....       MOV     DPTR,#SampleApp_Group
   \   000085   7411         MOV     A,#0x11
   \   000087   F0           MOVX    @DPTR,A
   \   000088   A3           INC     DPTR
   \   000089   7401         MOV     A,#0x1
   \   00008B   F0           MOVX    @DPTR,A
    184            osal_memcpy(SampleApp_Group.name, "Group 111", 9);	//组名
   \   00008C                ; Setup parameters for call to function osal_memcpy
   \   00008C   75....       MOV     ?V0,#`?<Constant "Group 111">` & 0xff
   \   00008F   75....       MOV     ?V1,#(`?<Constant "Group 111">` >> 8) & 0xff
   \   000092   75..00       MOV     ?V2,#0x0
   \   000095   78..         MOV     R0,#?V0
   \   000097   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00009A   7C09         MOV     R4,#0x9
   \   00009C   7D00         MOV     R5,#0x0
   \   00009E   7A..         MOV     R2,#(SampleApp_Group + 2) & 0xff
   \   0000A0   7B..         MOV     R3,#((SampleApp_Group + 2) >> 8) & 0xff
   \   0000A2   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   0000A5   7403         MOV     A,#0x3
   \   0000A7   12....       LCALL   ?DEALLOC_XSTACK8
    185            //4、将端点加入到组中
    186            aps_AddGroup(SAMPLEAPP_ENDPOINT,&SampleApp_Group);
   \   0000AA                ; Setup parameters for call to function aps_AddGroup
   \   0000AA   7A..         MOV     R2,#SampleApp_Group & 0xff
   \   0000AC   7B..         MOV     R3,#(SampleApp_Group >> 8) & 0xff
   \   0000AE   790B         MOV     R1,#0xb
   \   0000B0   12....       LCALL   `??aps_AddGroup::?relay`; Banked call to: aps_AddGroup
   \   0000B3   E9           MOV     A,R1
    187            
    188            //------------------------配置按键---------------------------------
    189              // Register for all key events - This app will handle all key events
    190            RegisterForKeys( SampleApp_TaskID );
   \   0000B4                ; Setup parameters for call to function RegisterForKeys
   \   0000B4   90....       MOV     DPTR,#SampleApp_TaskID
   \   0000B7   E0           MOVX    A,@DPTR
   \   0000B8   F9           MOV     R1,A
   \   0000B9   12....       LCALL   `??RegisterForKeys::?relay`; Banked call to: RegisterForKeys
   \   0000BC   E9           MOV     A,R1
    191            //------------------------配置串口---------------------------------
    192            MT_UartInit();                    //串口初始化
   \   0000BD                ; Setup parameters for call to function MT_UartInit
   \   0000BD   12....       LCALL   `??MT_UartInit::?relay`; Banked call to: MT_UartInit
    193            MT_UartRegisterTaskID(task_id);   //注册串口任务
   \   0000C0                ; Setup parameters for call to function MT_UartRegisterTaskID
   \   0000C0   EE           MOV     A,R6
   \   0000C1   F9           MOV     R1,A
   \   0000C2   12....       LCALL   `??MT_UartRegisterTaskID::?relay`; Banked call to: MT_UartRegisterTaskID
    194            HalUARTWrite(HAL_UART_PORT_0,"UartInit OK\n", sizeof("UartInit OK\n"));
   \   0000C5                ; Setup parameters for call to function HalUARTWrite
   \   0000C5   7C0D         MOV     R4,#0xd
   \   0000C7   7D00         MOV     R5,#0x0
   \   0000C9   7A..         MOV     R2,#`?<Constant "UartInit OK\\n">` & 0xff
   \   0000CB   7B..         MOV     R3,#(`?<Constant "UartInit OK\\n">` >> 8) & 0xff
   \   0000CD   7900         MOV     R1,#0x0
   \   0000CF   12....       LCALL   `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    195            //------------------------配置GPIO---------------------------------
    196            #if defined( ZDO_COORDINATOR ) 
    197              P0SEL &= ~0xF0;                 //设置P0.4 P0.5 P0.6 P0_7为普通IO口
    198              P0DIR |= 0xF0;                 //P0.4 P0.5 P0.6 P0.7定义为输出口
    199              RELAY = 1;  
    200            #else
    201            //20171025 add iic and bh1750  
    202              I2C_Init();
   \   0000D2                ; Setup parameters for call to function I2C_Init
   \   0000D2   12....       LCALL   `??I2C_Init::?relay` ; Banked call to: I2C_Init
    203              BH1750_Init();
   \   0000D5                ; Setup parameters for call to function BH1750_Init
   \   0000D5   12....       LCALL   `??BH1750_Init::?relay`; Banked call to: BH1750_Init
    204            //20171107 add PMS7003
    205              //PMS7003_Init();
    206            //20171202 add DS_CO2_20  
    207              //DS_CO2_20_Init();
    208            //20171203 add ZE03
    209              //ZE03_Init();
    210            //20171202 add soilhumi
    211              Soilhumi_Init();
   \   0000D8                ; Setup parameters for call to function Soilhumi_Init
   \   0000D8   12....       LCALL   `??Soilhumi_Init::?relay`; Banked call to: Soilhumi_Init
    212            #endif
    213          }
   \   0000DB   7F03         MOV     R7,#0x3
   \   0000DD   02....       LJMP    ?BANKED_LEAVE_XDATA
    214          
    215          /*********************************************************************
    216           * @fn      SampleApp_ProcessEvent
    217           *
    218           * @brief   Generic Application Task event processor.  This function
    219           *          is called to process all events for the task.  Events
    220           *          include timers, messages and any other user defined events.
    221           *
    222           * @param   task_id  - The OSAL assigned task ID.
    223           * @param   events - events to process.  This is a bit map and can
    224           *                   contain more than one event.
    225           *
    226           * @return  none
    227           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    228          uint16 SampleApp_ProcessEvent( uint8 task_id, uint16 events )
   \                     SampleApp_ProcessEvent:
    229          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V2,R1
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
   \   000009   EB           MOV     A,R3
   \   00000A   FF           MOV     R7,A
    230            afIncomingMSGPacket_t *MSGpkt;
    231            (void)task_id;  // Intentionally unreferenced parameter
    232            //uint8 addrTemp[2];
    233            
    234            if ( events & SYS_EVENT_MSG )
   \   00000B   EE           MOV     A,R6
   \   00000C   5400         ANL     A,#0x0
   \   00000E   F8           MOV     R0,A
   \   00000F   EF           MOV     A,R7
   \   000010   5480         ANL     A,#0x80
   \   000012   F9           MOV     R1,A
   \   000013   E8           MOV     A,R0
   \   000014   49           ORL     A,R1
   \   000015   7003         JNZ     $+5
   \   000017   02....       LJMP    ??SampleApp_ProcessEvent_0 & 0xFFFF
    235            {
    236              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SampleApp_TaskID );
   \   00001A                ; Setup parameters for call to function osal_msg_receive
   \   00001A   90....       MOV     DPTR,#SampleApp_TaskID
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F9           MOV     R1,A
   \   00001F   12....       LCALL   `??osal_msg_receive::?relay`; Banked call to: osal_msg_receive
   \   000022   8A..         MOV     ?V4,R2
   \   000024   8B..         MOV     ?V5,R3
   \   000026   85....       MOV     ?V0,?V4
   \   000029   85....       MOV     ?V1,?V5
    237              while ( MSGpkt )
   \                     ??SampleApp_ProcessEvent_1:
   \   00002C   E5..         MOV     A,?V0
   \   00002E   45..         ORL     A,?V1
   \   000030   7003         JNZ     $+5
   \   000032   02....       LJMP    ??SampleApp_ProcessEvent_2 & 0xFFFF
    238              {
    239                switch ( MSGpkt->hdr.event )
   \   000035   85..82       MOV     DPL,?V0
   \   000038   85..83       MOV     DPH,?V1
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   24E6         ADD     A,#-0x1a
   \   00003E   6024         JZ      ??SampleApp_ProcessEvent_3
   \   000040   245A         ADD     A,#0x5a
   \   000042   6006         JZ      ??SampleApp_ProcessEvent_4
   \   000044   24EF         ADD     A,#-0x11
   \   000046   6025         JZ      ??SampleApp_ProcessEvent_5
   \   000048   805B         SJMP    ??SampleApp_ProcessEvent_6
    240                {
    241                  // Received when a key is pressed
    242                  case KEY_CHANGE:
    243                    SampleApp_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
   \                     ??SampleApp_ProcessEvent_4:
   \   00004A                ; Setup parameters for call to function SampleApp_HandleKeys
   \   00004A   85..82       MOV     DPL,?V0
   \   00004D   85..83       MOV     DPH,?V1
   \   000050   A3           INC     DPTR
   \   000051   A3           INC     DPTR
   \   000052   A3           INC     DPTR
   \   000053   E0           MOVX    A,@DPTR
   \   000054   FA           MOV     R2,A
   \   000055   85..82       MOV     DPL,?V0
   \   000058   85..83       MOV     DPH,?V1
   \   00005B   A3           INC     DPTR
   \   00005C   A3           INC     DPTR
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F9           MOV     R1,A
   \   00005F   12....       LCALL   `??SampleApp_HandleKeys::?relay`; Banked call to: SampleApp_HandleKeys
    244                    break;
   \   000062   8041         SJMP    ??SampleApp_ProcessEvent_6
    245          
    246                  // Received when a messages is received (OTA) for this endpoint
    247                  case AF_INCOMING_MSG_CMD:
    248                    #if defined( ZDO_COORDINATOR ) 
    249                      SampleApp_coord_HandleMsg( MSGpkt );
    250                    #elif defined( RTR_NWK )
    251                      SampleApp_router_HandleMsg( MSGpkt );
    252                    #else
    253                      SampleApp_end_HandleMsg( MSGpkt );
   \                     ??SampleApp_ProcessEvent_3:
   \   000064                ; Setup parameters for call to function SampleApp_end_HandleMsg
   \   000064   AA..         MOV     R2,?V0
   \   000066   AB..         MOV     R3,?V1
   \   000068   12....       LCALL   `??SampleApp_end_HandleMsg::?relay`; Banked call to: SampleApp_end_HandleMsg
    254                    #endif
    255                    break;
   \   00006B   8038         SJMP    ??SampleApp_ProcessEvent_6
    256          
    257                  // Received whenever the device changes state in the network
    258                  case ZDO_STATE_CHANGE:
    259                    SampleApp_NwkState = (devStates_t)(MSGpkt->hdr.status);
   \                     ??SampleApp_ProcessEvent_5:
   \   00006D   85..82       MOV     DPL,?V0
   \   000070   85..83       MOV     DPH,?V1
   \   000073   A3           INC     DPTR
   \   000074   E0           MOVX    A,@DPTR
   \   000075   90....       MOV     DPTR,#SampleApp_NwkState
   \   000078   F0           MOVX    @DPTR,A
    260                    if ( (SampleApp_NwkState == DEV_ZB_COORD) ||  
    261                           (SampleApp_NwkState == DEV_ROUTER)
    262                        || (SampleApp_NwkState == DEV_END_DEVICE) )
   \   000079   90....       MOV     DPTR,#SampleApp_NwkState
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   6409         XRL     A,#0x9
   \   00007F   6010         JZ      ??SampleApp_ProcessEvent_7
   \   000081   90....       MOV     DPTR,#SampleApp_NwkState
   \   000084   E0           MOVX    A,@DPTR
   \   000085   6407         XRL     A,#0x7
   \   000087   6008         JZ      ??SampleApp_ProcessEvent_7
   \   000089   90....       MOV     DPTR,#SampleApp_NwkState
   \   00008C   E0           MOVX    A,@DPTR
   \   00008D   6406         XRL     A,#0x6
   \   00008F   7014         JNZ     ??SampleApp_ProcessEvent_6
    263                    { 
    264                      // Setup to send message again in normal period (+ a little jitter)
    265                    #if defined( ZDO_COORDINATOR )
    266                      osal_start_timerEx( SampleApp_TaskID, 
    267                                        SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    268                                        (SAMPLEAPP_SEND_PERIODIC_MSG_TIMEOUT_COORD + (osal_rand() & 0x00FF)) );
    269                    #else
    270                      SampleApp_Send_P2P_Message();
   \                     ??SampleApp_ProcessEvent_7:
   \   000091                ; Setup parameters for call to function SampleApp_Send_P2P_Message
   \   000091   12....       LCALL   `??SampleApp_Send_P2P_Message::?relay`; Banked call to: SampleApp_Send_P2P_Message
    271                      osal_start_timerEx( SampleApp_TaskID,
    272                                        SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    273                                        SAMPLEAPP_SEND_PERIODIC_MSG_TIMEOUT );
   \   000094                ; Setup parameters for call to function osal_start_timerEx
   \   000094   7CC8         MOV     R4,#-0x38
   \   000096   7D32         MOV     R5,#0x32
   \   000098   7A01         MOV     R2,#0x1
   \   00009A   7B00         MOV     R3,#0x0
   \   00009C   90....       MOV     DPTR,#SampleApp_TaskID
   \   00009F   E0           MOVX    A,@DPTR
   \   0000A0   F9           MOV     R1,A
   \   0000A1   12....       LCALL   `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   0000A4   E9           MOV     A,R1
    274                    #endif
    275                            
    276                    }
    277                    else
    278                    {
    279                      // Device is no longer in the network
    280                    }
    281                    break;
    282          
    283                  default:
    284                    break;
    285                }
    286          
    287                // Release the memory
    288                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??SampleApp_ProcessEvent_6:
   \   0000A5                ; Setup parameters for call to function osal_msg_deallocate
   \   0000A5   AA..         MOV     R2,?V0
   \   0000A7   AB..         MOV     R3,?V1
   \   0000A9   12....       LCALL   `??osal_msg_deallocate::?relay`; Banked call to: osal_msg_deallocate
   \   0000AC   E9           MOV     A,R1
    289          
    290                // Next - if one is available
    291                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SampleApp_TaskID );
   \   0000AD                ; Setup parameters for call to function osal_msg_receive
   \   0000AD   90....       MOV     DPTR,#SampleApp_TaskID
   \   0000B0   E0           MOVX    A,@DPTR
   \   0000B1   F9           MOV     R1,A
   \   0000B2   12....       LCALL   `??osal_msg_receive::?relay`; Banked call to: osal_msg_receive
   \   0000B5   8A..         MOV     ?V4,R2
   \   0000B7   8B..         MOV     ?V5,R3
   \   0000B9   85....       MOV     ?V0,?V4
   \   0000BC   85....       MOV     ?V1,?V5
   \   0000BF   02....       LJMP    ??SampleApp_ProcessEvent_1 & 0xFFFF
    292              }
    293          
    294              // return unprocessed events
    295              return (events ^ SYS_EVENT_MSG);
   \                     ??SampleApp_ProcessEvent_2:
   \   0000C2   EE           MOV     A,R6
   \   0000C3   6400         XRL     A,#0x0
   \   0000C5   FA           MOV     R2,A
   \   0000C6   EF           MOV     A,R7
   \   0000C7   6480         XRL     A,#0x80
   \   0000C9   FB           MOV     R3,A
   \   0000CA   804D         SJMP    ??SampleApp_ProcessEvent_8
    296            }
    297          
    298            // Send a message out - This event is generated by a timer
    299            //  (setup in SampleApp_Init()).
    300            if ( events & SAMPLEAPP_SEND_PERIODIC_MSG_EVT )
   \                     ??SampleApp_ProcessEvent_0:
   \   0000CC   EE           MOV     A,R6
   \   0000CD   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000CF   5035         JNC     ??SampleApp_ProcessEvent_9
    301            { 
    302              #if defined( ZDO_COORDINATOR )
    303                //something to do
    304              #elif defined( RTR_NWK )
    305                //something to do
    306              #else
    307                SampleApp_Send_P2P_Message();    // 终端或路由器周期处理函数   
   \   0000D1                ; Setup parameters for call to function SampleApp_Send_P2P_Message
   \   0000D1   12....       LCALL   `??SampleApp_Send_P2P_Message::?relay`; Banked call to: SampleApp_Send_P2P_Message
    308          
    309              // Setup to send message again in normal period (+ a little jitter)
    310              osal_start_timerEx( SampleApp_TaskID, SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    311                  (SAMPLEAPP_SEND_PERIODIC_MSG_TIMEOUT + (osal_rand() & 0x00FF)) );
   \   0000D4                ; Setup parameters for call to function osal_rand
   \   0000D4   12....       LCALL   `??osal_rand::?relay`; Banked call to: osal_rand
   \   0000D7   8A..         MOV     ?V4,R2
   \   0000D9   8B..         MOV     ?V5,R3
   \   0000DB   A8..         MOV     R0,?V4
   \   0000DD   A9..         MOV     R1,?V5
   \   0000DF                ; Setup parameters for call to function osal_start_timerEx
   \   0000DF   E8           MOV     A,R0
   \   0000E0   54FF         ANL     A,#0xff
   \   0000E2   F8           MOV     R0,A
   \   0000E3   E9           MOV     A,R1
   \   0000E4   5400         ANL     A,#0x0
   \   0000E6   F9           MOV     R1,A
   \   0000E7   E8           MOV     A,R0
   \   0000E8   24C8         ADD     A,#-0x38
   \   0000EA   FC           MOV     R4,A
   \   0000EB   E9           MOV     A,R1
   \   0000EC   3432         ADDC    A,#0x32
   \   0000EE   FD           MOV     R5,A
   \   0000EF   7A01         MOV     R2,#0x1
   \   0000F1   7B00         MOV     R3,#0x0
   \   0000F3   90....       MOV     DPTR,#SampleApp_TaskID
   \   0000F6   E0           MOVX    A,@DPTR
   \   0000F7   F9           MOV     R1,A
   \   0000F8   12....       LCALL   `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   0000FB   E9           MOV     A,R1
    312              #endif
    313              // return unprocessed events
    314              return (events ^ SAMPLEAPP_SEND_PERIODIC_MSG_EVT);
   \   0000FC   EE           MOV     A,R6
   \   0000FD   6401         XRL     A,#0x1
   \   0000FF   FA           MOV     R2,A
   \   000100   EF           MOV     A,R7
   \   000101   6400         XRL     A,#0x0
   \   000103   FB           MOV     R3,A
   \   000104   8013         SJMP    ??SampleApp_ProcessEvent_8
    315            }
    316            
    317            //20171108 add uart event
    318            if ( events & UART_RX_CB_EVT )
   \                     ??SampleApp_ProcessEvent_9:
   \   000106   EE           MOV     A,R6
   \   000107   5402         ANL     A,#0x2
   \   000109   600A         JZ      ??SampleApp_ProcessEvent_10
    319            {
    320              #if defined( ZDO_COORDINATOR ) 
    321                SampleApp_coord_HandlerUART();
    322              #elif defined( RTR_NWK )
    323                //something to do
    324              #else
    325                //something to do
    326              #endif
    327              // return unprocessed events
    328              return (events ^ UART_RX_CB_EVT);
   \   00010B   EE           MOV     A,R6
   \   00010C   6402         XRL     A,#0x2
   \   00010E   FA           MOV     R2,A
   \   00010F   EF           MOV     A,R7
   \   000110   6400         XRL     A,#0x0
   \   000112   FB           MOV     R3,A
   \   000113   8004         SJMP    ??SampleApp_ProcessEvent_8
    329          
    330            }
    331          
    332            // Discard unknown eventss
    333            return 0;
   \                     ??SampleApp_ProcessEvent_10:
   \   000115   7A00         MOV     R2,#0x0
   \   000117   7B00         MOV     R3,#0x0
   \                     ??SampleApp_ProcessEvent_8:
   \   000119   7F06         MOV     R7,#0x6
   \   00011B   02....       LJMP    ?BANKED_LEAVE_XDATA
    334          }
    335          
    336          /*********************************************************************
    337           * Event Generation Functions
    338           */
    339          /*********************************************************************
    340           * @fn      SampleApp_HandleKeys
    341           *
    342           * @brief   Handles all key events for this device.
    343           *
    344           * @param   shift - true if in shift/alt.
    345           * @param   keys - bit field for key events. Valid entries:
    346           *                 HAL_KEY_SW_6(S1)
    347           *                 HAL_KEY_SW_7(S2)
    348           *
    349           * @return  none
    350           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    351          void SampleApp_HandleKeys( uint8 shift, uint8 keys )
   \                     SampleApp_HandleKeys:
    352          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    353            (void)shift;  // Intentionally unreferenced parameter
    354            
    355            if ( keys & HAL_KEY_SW_6 )
    356            {   
    357            }
    358            if ( keys & HAL_KEY_SW_7 )
    359            {
    360            }
    361          
    362          }
   \   000000   02....       LJMP    ?BRET
    363          
    364          /*********************************************************************
    365           * LOCAL FUNCTIONS
    366           */
    367          
    368          /*********************************************************************
    369           * @fn      SampleApp_coord_HandleMsg
    370           *
    371           * @brief   Data message processor callback.  This function processes
    372           *          any incoming data - probably from other devices.  So, based
    373           *          on cluster ID, perform the intended action.
    374           *
    375           * @param   none
    376           *
    377           * @return  none
    378           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    379          void SampleApp_coord_HandleMsg( afIncomingMSGPacket_t *pkt )
   \                     SampleApp_coord_HandleMsg:
    380          { 
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    381            switch ( pkt->clusterId )
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F5..         MOV     ?V0,A
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   F5..         MOV     ?V1,A
   \   000018   78..         MOV     R0,#?V0
   \   00001A   12....       LCALL   ?US_SWITCH_DENSE
   \                     `?<Jumptable for SampleApp_coord_HandleMsg>_0`:
   \   00001D   0200         DW        2
   \   00001F   01           DB        1
   \   000020   ....         DW        ??SampleApp_coord_HandleMsg_0
   \   000022   ....         DW        ??SampleApp_coord_HandleMsg_0
   \   000024   ....         DW        ??SampleApp_coord_HandleMsg_1
    382            {
    383              case SAMPLEAPP_P2P_CLUSTERID: 
    384                HalUARTWrite(0, pkt->cmd.Data, pkt->cmd.DataLength);    //输出接收到的数据
   \                     ??SampleApp_coord_HandleMsg_1:
   \   000026                ; Setup parameters for call to function HalUARTWrite
   \   000026   EE           MOV     A,R6
   \   000027   2420         ADD     A,#0x20
   \   000029   F582         MOV     DPL,A
   \   00002B   E4           CLR     A
   \   00002C   3F           ADDC    A,R7
   \   00002D   F583         MOV     DPH,A
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   FC           MOV     R4,A
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   FD           MOV     R5,A
   \   000034   EE           MOV     A,R6
   \   000035   2422         ADD     A,#0x22
   \   000037   F582         MOV     DPL,A
   \   000039   E4           CLR     A
   \   00003A   3F           ADDC    A,R7
   \   00003B   F583         MOV     DPH,A
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   FA           MOV     R2,A
   \   00003F   A3           INC     DPTR
   \   000040   E0           MOVX    A,@DPTR
   \   000041   FB           MOV     R3,A
   \   000042   7900         MOV     R1,#0x0
   \   000044   12....       LCALL   `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    385                break;    
    386          
    387              case SAMPLEAPP_BROADCAST_CLUSTERID:    
    388                break;
    389              
    390              default:
    391                break;
    392            }
    393          }
   \                     ??SampleApp_coord_HandleMsg_0:
   \   000047   7F02         MOV     R7,#0x2
   \   000049   02....       LJMP    ?BANKED_LEAVE_XDATA
    394          
    395          
    396          
    397          /*********************************************************************
    398           * @fn      SampleApp_router_HandleMsg
    399           *
    400           * @brief   Data message processor callback.  This function processes
    401           *          any incoming data - probably from other devices.  So, based
    402           *          on cluster ID, perform the intended action.
    403           *
    404           * @param   none
    405           *
    406           * @return  none
    407           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    408          void SampleApp_router_HandleMsg( afIncomingMSGPacket_t *pkt )
   \                     SampleApp_router_HandleMsg:
    409          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    410            switch ( pkt->clusterId )
   \   000005   8A82         MOV     DPL,R2
   \   000007   8B83         MOV     DPH,R3
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   A3           INC     DPTR
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F5..         MOV     ?V0,A
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F5..         MOV     ?V1,A
   \   000014   78..         MOV     R0,#?V0
   \   000016   12....       LCALL   ?US_SWITCH_DENSE
   \                     `?<Jumptable for SampleApp_router_HandleMsg>_0`:
   \   000019   0200         DW        2
   \   00001B   01           DB        1
   \   00001C   ....         DW        ??SampleApp_router_HandleMsg_0
   \   00001E   ....         DW        ??SampleApp_router_HandleMsg_0
   \   000020   ....         DW        ??SampleApp_router_HandleMsg_1
    411            {
    412              case SAMPLEAPP_P2P_CLUSTERID:
    413                if( pkt->cmd.Data[0] == 'L'  )
   \                     ??SampleApp_router_HandleMsg_1:
   \   000022   EA           MOV     A,R2
   \   000023   2422         ADD     A,#0x22
   \   000025   F582         MOV     DPL,A
   \   000027   E4           CLR     A
   \   000028   3B           ADDC    A,R3
   \   000029   F583         MOV     DPH,A
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F8           MOV     R0,A
   \   00002D   A3           INC     DPTR
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   F583         MOV     DPH,A
   \   000031   8882         MOV     DPL,R0
   \   000033   E0           MOVX    A,@DPTR
   \   000034   644C         XRL     A,#0x4c
    414                {
    415                }
    416                else if( pkt->cmd.Data[0] == 'D' )
    417                { 
    418                }
    419                break;
    420                
    421              case SAMPLEAPP_BROADCAST_CLUSTERID:
    422                break;
    423              
    424              default:
    425                break;
    426            }
    427          }
   \                     ??SampleApp_router_HandleMsg_0:
   \   000036   7F02         MOV     R7,#0x2
   \   000038   02....       LJMP    ?BANKED_LEAVE_XDATA
    428          
    429          
    430          /*********************************************************************
    431           * @fn      SampleApp_end_HandleMsg
    432           *
    433           * @brief   Data message processor callback.  This function processes
    434           *          any incoming data - probably from other devices.  So, based
    435           *          on cluster ID, perform the intended action.
    436           *
    437           * @param   none
    438           *
    439           * @return  none
    440           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    441          void SampleApp_end_HandleMsg( afIncomingMSGPacket_t *pkt )
   \                     SampleApp_end_HandleMsg:
    442          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    443            switch ( pkt->clusterId )
   \   000005   8A82         MOV     DPL,R2
   \   000007   8B83         MOV     DPH,R3
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   A3           INC     DPTR
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F5..         MOV     ?V0,A
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F5..         MOV     ?V1,A
   \   000014   78..         MOV     R0,#?V0
   \   000016   12....       LCALL   ?US_SWITCH_DENSE
   \                     `?<Jumptable for SampleApp_end_HandleMsg>_0`:
   \   000019   0200         DW        2
   \   00001B   01           DB        1
   \   00001C   ....         DW        ??SampleApp_end_HandleMsg_0
   \   00001E   ....         DW        ??SampleApp_end_HandleMsg_0
   \   000020   ....         DW        ??SampleApp_end_HandleMsg_1
    444            {
    445              case SAMPLEAPP_P2P_CLUSTERID:
    446                if( pkt->cmd.Data[0] == 'L'  )
   \                     ??SampleApp_end_HandleMsg_1:
   \   000022   EA           MOV     A,R2
   \   000023   2422         ADD     A,#0x22
   \   000025   F582         MOV     DPL,A
   \   000027   E4           CLR     A
   \   000028   3B           ADDC    A,R3
   \   000029   F583         MOV     DPH,A
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F8           MOV     R0,A
   \   00002D   A3           INC     DPTR
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   F583         MOV     DPH,A
   \   000031   8882         MOV     DPL,R0
   \   000033   E0           MOVX    A,@DPTR
   \   000034   644C         XRL     A,#0x4c
    447                {
    448                }
    449                else if( pkt->cmd.Data[0] == 'D' )
    450                { 
    451                }
    452                break;
    453          
    454              case SAMPLEAPP_BROADCAST_CLUSTERID:
    455                break;
    456              
    457              default:
    458                break;
    459            }
    460          }
   \                     ??SampleApp_end_HandleMsg_0:
   \   000036   7F02         MOV     R7,#0x2
   \   000038   02....       LJMP    ?BANKED_LEAVE_XDATA
    461          
    462          
    463          /*********************************************************************
    464           * @fn      SampleApp_coord_HandlerUART
    465           *
    466           * @brief   Handle the message from UART.
    467           *
    468           * @param   none
    469           *
    470           * @return  none
    471           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    472          void SampleApp_coord_HandlerUART(void)
   \                     SampleApp_coord_HandlerUART:
    473          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    474            HalUARTWrite ( HAL_UART_PORT_0, MT_RX_Buffer , rxLen ); // display back for test
   \   000004                ; Setup parameters for call to function HalUARTWrite
   \   000004   90....       MOV     DPTR,#rxLen
   \   000007   E0           MOVX    A,@DPTR
   \   000008   FC           MOV     R4,A
   \   000009   A3           INC     DPTR
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   FD           MOV     R5,A
   \   00000C   7A..         MOV     R2,#MT_RX_Buffer & 0xff
   \   00000E   7B..         MOV     R3,#(MT_RX_Buffer >> 8) & 0xff
   \   000010   7900         MOV     R1,#0x0
   \   000012   12....       LCALL   `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    475          }
   \   000015   D083         POP     DPH
   \   000017   D082         POP     DPL
   \   000019   02....       LJMP    ?BRET
    476          
    477          
    478          /*********************************************************************
    479           * @fn      SampleApp_Send_P2P_Message
    480           *
    481           * @brief   point to point.(cost about 3.5s)
    482           *
    483           * @param   none
    484           *
    485           * @return  none
    486           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    487          void SampleApp_Send_P2P_Message( void )
   \                     SampleApp_Send_P2P_Message:
    488          { 
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 26
   \   000005   74E6         MOV     A,#-0x1a
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    489            static char deviceID = 1;                          //终端节点设备号
    490            unsigned char frame[14];
    491            unsigned char light[2],air_temp_humi[5],soil_temp_humi[5];
    492            
    493            osal_memset(light,'\0',sizeof(light));
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C02         MOV     R4,#0x2
   \   00000C   7D00         MOV     R5,#0x0
   \   00000E   7900         MOV     R1,#0x0
   \   000010   AA..         MOV     R2,?XSP + 0
   \   000012   AB..         MOV     R3,?XSP + 1
   \   000014   12....       LCALL   `??osal_memset::?relay`; Banked call to: osal_memset
    494            osal_memset(air_temp_humi,'\0',sizeof(air_temp_humi));
   \   000017                ; Setup parameters for call to function osal_memset
   \   000017   7C05         MOV     R4,#0x5
   \   000019   7D00         MOV     R5,#0x0
   \   00001B   7900         MOV     R1,#0x0
   \   00001D   7407         MOV     A,#0x7
   \   00001F   12....       LCALL   ?XSTACK_DISP101_8
   \   000022   12....       LCALL   `??osal_memset::?relay`; Banked call to: osal_memset
    495            osal_memset(soil_temp_humi,'\0',sizeof(soil_temp_humi));
   \   000025                ; Setup parameters for call to function osal_memset
   \   000025   7C05         MOV     R4,#0x5
   \   000027   7D00         MOV     R5,#0x0
   \   000029   7900         MOV     R1,#0x0
   \   00002B   7402         MOV     A,#0x2
   \   00002D   12....       LCALL   ?XSTACK_DISP101_8
   \   000030   12....       LCALL   `??osal_memset::?relay`; Banked call to: osal_memset
    496            osal_memset(frame,'\0',sizeof(frame));
   \   000033                ; Setup parameters for call to function osal_memset
   \   000033   7C0E         MOV     R4,#0xe
   \   000035   7D00         MOV     R5,#0x0
   \   000037   7900         MOV     R1,#0x0
   \   000039   740C         MOV     A,#0xc
   \   00003B   12....       LCALL   ?XSTACK_DISP101_8
   \   00003E   12....       LCALL   `??osal_memset::?relay`; Banked call to: osal_memset
    497          
    498            BH1750_Read(light);                       //2byte
   \   000041                ; Setup parameters for call to function BH1750_Read
   \   000041   AA..         MOV     R2,?XSP + 0
   \   000043   AB..         MOV     R3,?XSP + 1
   \   000045   12....       LCALL   `??BH1750_Read::?relay`; Banked call to: BH1750_Read
   \   000048   E9           MOV     A,R1
    499            SHT10_Read(air_temp_humi);                //4+1byte
   \   000049                ; Setup parameters for call to function SHT10_Read
   \   000049   7407         MOV     A,#0x7
   \   00004B   12....       LCALL   ?XSTACK_DISP101_8
   \   00004E   12....       LCALL   `??SHT10_Read::?relay`; Banked call to: SHT10_Read
   \   000051   E9           MOV     A,R1
    500            Ds18B20_Readfloat(soil_temp_humi);        //4byte
   \   000052                ; Setup parameters for call to function Ds18B20_Readfloat
   \   000052   7402         MOV     A,#0x2
   \   000054   12....       LCALL   ?XSTACK_DISP101_8
   \   000057   12....       LCALL   `??Ds18B20_Readfloat::?relay`; Banked call to: Ds18B20_Readfloat
   \   00005A   E9           MOV     A,R1
    501            Soilhumi_Read(soil_temp_humi+4);          //1byte
   \   00005B                ; Setup parameters for call to function Soilhumi_Read
   \   00005B   7406         MOV     A,#0x6
   \   00005D   12....       LCALL   ?XSTACK_DISP0_8
   \   000060   AA82         MOV     R2,DPL
   \   000062   AB83         MOV     R3,DPH
   \   000064   12....       LCALL   `??Soilhumi_Read::?relay`; Banked call to: Soilhumi_Read
   \   000067   E9           MOV     A,R1
    502              
    503          //将数据整合后方便发给协调器显示
    504            frame[0] = deviceID;
   \   000068   90....       MOV     DPTR,#??deviceID
   \   00006B   E0           MOVX    A,@DPTR
   \   00006C   C0E0         PUSH    A
   \   00006E   740C         MOV     A,#0xc
   \   000070   12....       LCALL   ?XSTACK_DISP0_8
   \   000073   D0E0         POP     A
   \   000075   F0           MOVX    @DPTR,A
    505            osal_memcpy(&frame[1], light, 2); 
   \   000076                ; Setup parameters for call to function osal_memcpy
   \   000076   A8..         MOV     R0,?XSP + 0
   \   000078   A9..         MOV     R1,?XSP + 1
   \   00007A   88..         MOV     ?V0,R0
   \   00007C   89..         MOV     ?V1,R1
   \   00007E   75..00       MOV     ?V2,#0x0
   \   000081   78..         MOV     R0,#?V0
   \   000083   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000086   7C02         MOV     R4,#0x2
   \   000088   7D00         MOV     R5,#0x0
   \   00008A   7410         MOV     A,#0x10
   \   00008C   12....       LCALL   ?XSTACK_DISP0_8
   \   00008F   AA82         MOV     R2,DPL
   \   000091   AB83         MOV     R3,DPH
   \   000093   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000096   7403         MOV     A,#0x3
   \   000098   12....       LCALL   ?DEALLOC_XSTACK8
    506            osal_memcpy(&frame[3], air_temp_humi, 5);
   \   00009B                ; Setup parameters for call to function osal_memcpy
   \   00009B   7407         MOV     A,#0x7
   \   00009D   12....       LCALL   ?XSTACK_DISP100_8
   \   0000A0   88..         MOV     ?V0,R0
   \   0000A2   89..         MOV     ?V1,R1
   \   0000A4   75..00       MOV     ?V2,#0x0
   \   0000A7   78..         MOV     R0,#?V0
   \   0000A9   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000AC   7C05         MOV     R4,#0x5
   \   0000AE   7D00         MOV     R5,#0x0
   \   0000B0   7412         MOV     A,#0x12
   \   0000B2   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B5   AA82         MOV     R2,DPL
   \   0000B7   AB83         MOV     R3,DPH
   \   0000B9   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   0000BC   7403         MOV     A,#0x3
   \   0000BE   12....       LCALL   ?DEALLOC_XSTACK8
    507            osal_memcpy(&frame[8], soil_temp_humi, 5);
   \   0000C1                ; Setup parameters for call to function osal_memcpy
   \   0000C1   7402         MOV     A,#0x2
   \   0000C3   12....       LCALL   ?XSTACK_DISP100_8
   \   0000C6   88..         MOV     ?V0,R0
   \   0000C8   89..         MOV     ?V1,R1
   \   0000CA   75..00       MOV     ?V2,#0x0
   \   0000CD   78..         MOV     R0,#?V0
   \   0000CF   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000D2   7C05         MOV     R4,#0x5
   \   0000D4   7D00         MOV     R5,#0x0
   \   0000D6   7417         MOV     A,#0x17
   \   0000D8   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DB   AA82         MOV     R2,DPL
   \   0000DD   AB83         MOV     R3,DPH
   \   0000DF   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   0000E2   7403         MOV     A,#0x3
   \   0000E4   12....       LCALL   ?DEALLOC_XSTACK8
    508            frame[13] = '\n';
   \   0000E7   7419         MOV     A,#0x19
   \   0000E9   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EC   740A         MOV     A,#0xa
   \   0000EE   F0           MOVX    @DPTR,A
    509              
    510          //发给协调器
    511            SampleApp_P2P_DstAddr.addr.shortAddr = 0x0000;             
   \   0000EF   90....       MOV     DPTR,#SampleApp_P2P_DstAddr
   \   0000F2   7400         MOV     A,#0x0
   \   0000F4   F0           MOVX    @DPTR,A
   \   0000F5   A3           INC     DPTR
   \   0000F6   7400         MOV     A,#0x0
   \   0000F8   F0           MOVX    @DPTR,A
    512            if ( AF_DataRequest( &SampleApp_P2P_DstAddr, &SampleApp_epDesc,
    513                                 SAMPLEAPP_P2P_CLUSTERID,
    514                                 13,
    515                                 (uint8 *)frame,
    516                                 &SampleApp_TransID,
    517                                 AF_DISCV_ROUTE,
    518                                 AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   0000F9                ; Setup parameters for call to function AF_DataRequest
   \   0000F9   75..1E       MOV     ?V0,#0x1e
   \   0000FC   78..         MOV     R0,#?V0
   \   0000FE   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000101   75....       MOV     ?V0,#SampleApp_TransID & 0xff
   \   000104   75....       MOV     ?V1,#(SampleApp_TransID >> 8) & 0xff
   \   000107   78..         MOV     R0,#?V0
   \   000109   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00010C   740F         MOV     A,#0xf
   \   00010E   12....       LCALL   ?XSTACK_DISP100_8
   \   000111   88..         MOV     ?V0,R0
   \   000113   89..         MOV     ?V1,R1
   \   000115   78..         MOV     R0,#?V0
   \   000117   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00011A   75..0D       MOV     ?V0,#0xd
   \   00011D   75..00       MOV     ?V1,#0x0
   \   000120   78..         MOV     R0,#?V0
   \   000122   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000125   75..03       MOV     ?V0,#0x3
   \   000128   75..00       MOV     ?V1,#0x0
   \   00012B   78..         MOV     R0,#?V0
   \   00012D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000130   7920         MOV     R1,#0x20
   \   000132   7C..         MOV     R4,#SampleApp_epDesc & 0xff
   \   000134   7D..         MOV     R5,#(SampleApp_epDesc >> 8) & 0xff
   \   000136   7A..         MOV     R2,#SampleApp_P2P_DstAddr & 0xff
   \   000138   7B..         MOV     R3,#(SampleApp_P2P_DstAddr >> 8) & 0xff
   \   00013A   12....       LCALL   `??AF_DataRequest::?relay`; Banked call to: AF_DataRequest
   \   00013D   7409         MOV     A,#0x9
   \   00013F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000142   E9           MOV     A,R1
   \   000143   7015         JNZ     ??SampleApp_Send_P2P_Message_0
    519            {
    520              //do nothing
    521              deviceID++;
   \   000145   90....       MOV     DPTR,#??deviceID
   \   000148   E0           MOVX    A,@DPTR
   \   000149   2401         ADD     A,#0x1
   \   00014B   F0           MOVX    @DPTR,A
    522              if(deviceID == 4)
   \   00014C   90....       MOV     DPTR,#??deviceID
   \   00014F   E0           MOVX    A,@DPTR
   \   000150   6404         XRL     A,#0x4
   \   000152   7006         JNZ     ??SampleApp_Send_P2P_Message_0
    523                deviceID = 1;
   \   000154   90....       MOV     DPTR,#??deviceID
   \   000157   7401         MOV     A,#0x1
   \   000159   F0           MOVX    @DPTR,A
    524            }
    525            else
    526            {
    527              // do nothing error occurred .
    528            }
    529          }
   \                     ??SampleApp_Send_P2P_Message_0:
   \   00015A   741A         MOV     A,#0x1a
   \   00015C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00015F   7F03         MOV     R7,#0x3
   \   000161   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_I, align 1, keep-with-next
   \                     ??deviceID:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for deviceID>`
   \   000001                REQUIRE __INIT_XDATA_I
    530          
    531          //20171108 add uartcallback

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    532          void MT_UartRXCB ( uint8 port, uint8 event )
   \                     MT_UartRXCB:
    533          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
    534            rxLen  = Hal_UART_RxBufLen(HAL_UART_PORT_0);
   \   000009                ; Setup parameters for call to function Hal_UART_RxBufLen
   \   000009   7900         MOV     R1,#0x0
   \   00000B   12....       LCALL   `??Hal_UART_RxBufLen::?relay`; Banked call to: Hal_UART_RxBufLen
   \   00000E   90....       MOV     DPTR,#rxLen
   \   000011   EA           MOV     A,R2
   \   000012   F0           MOVX    @DPTR,A
   \   000013   A3           INC     DPTR
   \   000014   EB           MOV     A,R3
   \   000015   F0           MOVX    @DPTR,A
    535            
    536            if ((event & (HAL_UART_RX_FULL | HAL_UART_RX_ABOUT_FULL | HAL_UART_RX_TIMEOUT)))
   \   000016   7407         MOV     A,#0x7
   \   000018   5E           ANL     A,R6
   \   000019   601E         JZ      ??MT_UartRXCB_0
    537            {   
    538              HalUARTRead( HAL_UART_PORT_0, MT_RX_Buffer, rxLen );
   \   00001B                ; Setup parameters for call to function HalUARTRead
   \   00001B   90....       MOV     DPTR,#rxLen
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   FC           MOV     R4,A
   \   000020   A3           INC     DPTR
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FD           MOV     R5,A
   \   000023   7A..         MOV     R2,#MT_RX_Buffer & 0xff
   \   000025   7B..         MOV     R3,#(MT_RX_Buffer >> 8) & 0xff
   \   000027   7900         MOV     R1,#0x0
   \   000029   12....       LCALL   `??HalUARTRead::?relay`; Banked call to: HalUARTRead
    539              osal_set_event(SampleApp_TaskID, UART_RX_CB_EVT);
   \   00002C                ; Setup parameters for call to function osal_set_event
   \   00002C   7A02         MOV     R2,#0x2
   \   00002E   7B00         MOV     R3,#0x0
   \   000030   90....       MOV     DPTR,#SampleApp_TaskID
   \   000033   E0           MOVX    A,@DPTR
   \   000034   F9           MOV     R1,A
   \   000035   12....       LCALL   `??osal_set_event::?relay`; Banked call to: osal_set_event
   \   000038   E9           MOV     A,R1
    540            }
    541          }
   \                     ??MT_UartRXCB_0:
   \   000039   7F01         MOV     R7,#0x1
   \   00003B   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for deviceID>`:
   \   000000   01           DB 1

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??SampleApp_Init::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??SampleApp_ProcessEvent::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??SampleApp_HandleKeys::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_HandleKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??SampleApp_coord_HandleMsg::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_coord_HandleMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??SampleApp_router_HandleMsg::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_router_HandleMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??SampleApp_end_HandleMsg::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_end_HandleMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??SampleApp_coord_HandlerUART::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_coord_HandlerUART

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??SampleApp_Send_P2P_Message::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_Send_P2P_Message

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_UartRXCB::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_UartRXCB

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Group 111">`:
   \   000000   47726F75     DB "Group 111"
   \            70203131
   \            3100    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "UartInit OK\\n">`:
   \   000000   55617274     DB "UartInit OK\012"
   \            496E6974
   \            204F4B0A
   \            00      
    542          
    543          
    544          /*********************************************************************
    545          *********************************************************************/

   Maximum stack usage in bytes:

   ISTACK XSTACK Function
   ------ ------ --------
      0      9   MT_UartRXCB
        0      9   -> HalUARTRead
        0      9   -> Hal_UART_RxBufLen
        0      9   -> osal_set_event
      0     14   SampleApp_HandleKeys
      0     14   SampleApp_Init
        0     11   -> BH1750_Init
        0     11   -> HalUARTWrite
        0     11   -> I2C_Init
        0     11   -> MT_UartInit
        0     11   -> MT_UartRegisterTaskID
        0     11   -> RegisterForKeys
        0     11   -> Soilhumi_Init
        0     11   -> afRegister
        0     11   -> aps_AddGroup
        0     14   -> osal_memcpy
      0     14   SampleApp_ProcessEvent
        0     14   -> SampleApp_HandleKeys
        0     14   -> SampleApp_Send_P2P_Message
        0     14   -> SampleApp_end_HandleMsg
        0     14   -> osal_msg_deallocate
        0     14   -> osal_msg_receive
        0     14   -> osal_rand
        0     14   -> osal_start_timerEx
      1     60   SampleApp_Send_P2P_Message
        0     46   -> AF_DataRequest
        0     37   -> BH1750_Read
        0     37   -> Ds18B20_Readfloat
        0     37   -> SHT10_Read
        0     37   -> Soilhumi_Read
        0     40   -> osal_memcpy
        0     37   -> osal_memset
      0     10   SampleApp_coord_HandleMsg
        0     10   -> HalUARTWrite
      2      0   SampleApp_coord_HandlerUART
        2      0   -> HalUARTWrite
      0     24   SampleApp_end_HandleMsg
      0     10   SampleApp_router_HandleMsg


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
      10  ?<Constant "Group 111">
      13  ?<Constant "UartInit OK\n">
       1  ?<Initializer for deviceID>
       1  LedState
      62  MT_UartRXCB
       6  MT_UartRXCB::?relay
      12  SampleApp_Broadcast_DstAddr
       6  SampleApp_ClusterList
      18  SampleApp_Group
      12  SampleApp_Group_DstAddr
       3  SampleApp_HandleKeys
       6  SampleApp_HandleKeys::?relay
     224  SampleApp_Init
       6  SampleApp_Init::?relay
       1  SampleApp_NwkState
      12  SampleApp_P2P_DstAddr
     286  SampleApp_ProcessEvent
       6  SampleApp_ProcessEvent::?relay
     356  SampleApp_Send_P2P_Message
       6  SampleApp_Send_P2P_Message::?relay
      12  SampleApp_SimpleDesc
       1  SampleApp_TaskID
       1  SampleApp_TransID
      76  SampleApp_coord_HandleMsg
       6  SampleApp_coord_HandleMsg::?relay
      28  SampleApp_coord_HandlerUART
       6  SampleApp_coord_HandlerUART::?relay
      59  SampleApp_end_HandleMsg
       6  SampleApp_end_HandleMsg::?relay
       6  SampleApp_epDesc
      59  SampleApp_router_HandleMsg
       6  SampleApp_router_HandleMsg::?relay
       1  deviceID
       1  len
       5  lightbuf
       2  myRXbuf

 
 1 153 bytes in segment BANKED_CODE
    54 bytes in segment BANK_RELAYS
     1 byte  in segment XDATA_I
     1 byte  in segment XDATA_ID
    41 bytes in segment XDATA_ROM_C
    72 bytes in segment XDATA_Z
 
 1 208 bytes of CODE  memory
    41 bytes of CONST memory
    73 bytes of XDATA memory

Errors: none
Warnings: none
